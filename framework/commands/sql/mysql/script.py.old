import base64

if len(api.argv) != 2:
    api.exit(api.help)

relPath  = api.argv[1]

if relPath.endswith(api.slash):
    api.exit(api.help)

Q['FILE'] = rpath.abspath(relPath)

payload  = php.loadfile('payload.php')
R = php.request(payload,Q)

err = error.check(R)
if err.exists:
    if   err.name == 'noexists'  : err.write(Q['FILE']+": No such file or directory")
    elif err.name == 'notafile':   err.write(Q['FILE']+": Not a file")
    elif err.name == 'noread':     err.write(Q['FILE']+": Permission denied")
    else:                          err.unknown()
    api.exit()

if not R:
    print ''
else:
    print base64.b64decode(R)
